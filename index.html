
<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LOGBOOK</title>

<style>
:root{
--bg:#050509;
--surface:#0d0d14;
--primary:#ff0000;
--text:#f5f5f7;
--muted:#9aa0a6;
--border:rgba(255,255,255,.15);
}

*{margin:0;padding:0;box-sizing:border-box}
body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;background:var(--bg);color:var(--text);padding-bottom:100px}
.header{background:var(--surface);padding:1rem;position:sticky;top:0;z-index:100;border-bottom:1px solid var(--border)}
.header h1{font-size:1.4rem;color:var(--primary)}
.tabs{display:flex;gap:.5rem;padding:1rem;overflow-x:auto;background:var(--bg);border-bottom:1px solid var(--border)}
.tab{padding:.5rem 1rem;background:var(--surface);border:none;color:var(--muted);border-radius:6px;cursor:pointer}
.tab.active{background:var(--primary);color:#000;font-weight:600}
.section{display:none;padding:1rem}
.section.active{display:block}
.card{background:var(--surface);padding:1rem;border-radius:8px;margin-bottom:1rem;border:1px solid var(--border)}
button{width:100%;padding:.7rem;margin-top:.5rem;background:var(--primary);color:#000;border:none;border-radius:6px;font-weight:600}
textarea,input,select{width:100%;padding:.6rem;margin-bottom:.5rem;background:var(--bg);color:var(--text);border:1px solid var(--border);border-radius:6px}
.exercise-block{background:#000;padding:.8rem;border-radius:6px;margin-bottom:.8rem}
.set-row{display:flex;gap:.5rem;margin-bottom:.5rem}
.set-row input{flex:1}
.small-btn{width:auto;padding:.3rem .5rem;font-size:.75rem;margin-top:0}
.list-item{background:#000;padding:.8rem;border-radius:6px;margin-bottom:.6rem}
.result{margin-top:1rem;padding:.8rem;background:#000;border-radius:6px;font-weight:600;text-align:center}
.photo-grid img{width:100%;border-radius:6px;margin-bottom:.5rem}
.stat{margin-bottom:.4rem}
</style>
</head>

<body>

<div class="header"><h1>LOGBOOK</h1></div>

<div class="tabs">
<button class="tab active" onclick="showTab('dashboard',this)">Dashboard</button>
<button class="tab" onclick="showTab('rotina',this)">Rotina</button>
<button class="tab" onclick="showTab('logbook',this)">Logbook</button>
<button class="tab" onclick="showTab('tdee',this)">TDEE</button>
<button class="tab" onclick="showTab('fisico',this)">Físico</button>
<button class="tab" onclick="showTab('backup',this)">Backup</button>
</div>

<div id="dashboard" class="section active">
<div class="card"><h3>Resumo</h3><div id="dashboardStats"></div></div>
</div>

<div id="rotina" class="section">
<div class="card">
<h3>Rotina Semanal</h3>
<textarea id="routineText"></textarea>
<button onclick="saveRoutine()">Salvar Rotina</button>
</div>
</div>

<div id="logbook" class="section">
<div class="card">
<h3 id="todayRoutineTitle"></h3>
<div id="exerciseContainer"></div>
<button onclick="addExercise()">Adicionar Exercício</button>
<button onclick="saveSession()">Salvar Sessão</button>
</div>

<div class="card">
<h3>Histórico</h3>
<div id="history"></div>
</div>
</div>

<div id="tdee" class="section">
<div class="card">
<h3>Calculadora TDEE</h3>
<select id="gender"><option value="male">Masculino</option><option value="female">Feminino</option></select>
<input type="number" id="age" placeholder="Idade">
<input type="number" id="height" placeholder="Altura (cm)">
<input type="number" id="weight" placeholder="Peso (kg)">
<select id="activity">
<option value="1.2">Sedentário</option>
<option value="1.55">Moderado</option>
<option value="1.9">Intenso</option>
</select>
<button onclick="calculateTDEE()">Calcular</button>
<div id="tdeeResult" class="result"></div>
</div>
</div>

<div id="fisico" class="section">
<div class="card">
<h3>Progresso Físico</h3>
<input type="date" id="photoDate">
<input type="number" id="photoWeight" placeholder="Peso">
<input type="file" id="photoFiles" multiple accept="image/*">
<button onclick="savePhotos()">Salvar Fotos</button>
</div>
<div class="card"><div id="photoHistory" class="photo-grid"></div></div>
</div>

<div id="backup" class="section">
<div class="card">
<h3>Backup</h3>
<button onclick="exportBackup()">Exportar Backup</button>
<input type="file" id="importFile">
<button onclick="importBackup()">Importar Backup</button>
</div>
</div>

<script>

let data={routine:"",sessions:[],photos:[],tdee:null};

function saveData(){localStorage.setItem("LOGBOOK_DATA",JSON.stringify(data));}
function loadData(){const s=localStorage.getItem("LOGBOOK_DATA");if(s){data=JSON.parse(s);}renderAll();}

function showTab(id,btn){
document.querySelectorAll(".section").forEach(s=>s.classList.remove("active"));
document.querySelectorAll(".tab").forEach(t=>t.classList.remove("active"));
document.getElementById(id).classList.add("active");
btn.classList.add("active");
}

function saveRoutine(){data.routine=document.getElementById("routineText").value;saveData();}

function getTodayRoutine(){
const days=["Domingo","Segunda","Terça","Quarta","Quinta","Sexta","Sábado"];
const today=days[new Date().getDay()];
const lines=data.routine.split("\n");
for(const l of lines){if(l.startsWith(today)){return l;}}
return today;
}

function addExercise(){
const div=document.createElement("div");
div.className="exercise-block";
div.innerHTML=`
<input placeholder="Nome do Exercício">
<div class="sets"></div>
<button class="small-btn" onclick="addSet(this)">Adicionar Set</button>
<button class="small-btn" onclick="this.parentElement.remove()">Remover Exercício</button>
`;
document.getElementById("exerciseContainer").appendChild(div);
}

function addSet(btn){
const setsDiv=btn.parentElement.querySelector(".sets");
const row=document.createElement("div");
row.className="set-row";
row.innerHTML=`
<input type="number" placeholder="Peso">
<input type="number" placeholder="Reps">
<input type="number" placeholder="RIR">
<button class="small-btn" onclick="this.parentElement.remove()">X</button>
`;
setsDiv.appendChild(row);
}

function saveSession(){
const exercises=[];
document.querySelectorAll(".exercise-block").forEach(block=>{
const name=block.querySelector("input").value;
const sets=[];
block.querySelectorAll(".set-row").forEach(row=>{
const inputs=row.querySelectorAll("input");
const weight=inputs[0].value;
const reps=inputs[1].value;
const rir=inputs[2].value;
if(weight && reps){sets.push({weight:parseFloat(weight),reps:parseInt(reps),rir});}
});
if(name && sets.length){exercises.push({name,sets});}
});
if(!exercises.length)return;
data.sessions.push({date:new Date().toLocaleDateString(),routine:getTodayRoutine(),exercises});
saveData();
document.getElementById("exerciseContainer").innerHTML="";
renderAll();
}

function calculateVolume(session){
let volume=0;
session.exercises.forEach(e=>{e.sets.forEach(s=>{volume+=s.weight*s.reps;});});
return volume;
}

function renderHistory(){
const h=document.getElementById("history");
h.innerHTML=data.sessions.map(s=>`
<div class="list-item">
<strong>${s.routine}</strong><br>
${s.exercises.map(e=>e.name+"<br>"+e.sets.map(st=>st.weight+"kg x "+st.reps+" (RIR "+(st.rir||"-")+")").join("<br>")).join("<br>")}
<br><strong>Volume: ${calculateVolume(s)} kg</strong>
<br>${s.date}
</div>`).join("");
}

function calculateTDEE(){
const g=document.getElementById("gender").value;
const a=parseInt(document.getElementById("age").value);
const h=parseInt(document.getElementById("height").value);
const w=parseInt(document.getElementById("weight").value);
const act=parseFloat(document.getElementById("activity").value);
if(!a||!h||!w)return;
let bmr=g==="male"?10*w+6.25*h-5*a+5:10*w+6.25*h-5*a-161;
let tdee=Math.round(bmr*act);
data.tdee=tdee;
saveData();
document.getElementById("tdeeResult").innerHTML="TDEE: "+tdee+" kcal";
renderDashboard();
}

function savePhotos(){
const files=[...document.getElementById("photoFiles").files];
const date=document.getElementById("photoDate").value;
const weight=document.getElementById("photoWeight").value;
files.forEach(f=>{
const reader=new FileReader();
reader.onload=e=>{data.photos.push({url:e.target.result,date,weight});saveData();renderPhotos();};
reader.readAsDataURL(f);
});
}

function renderPhotos(){
document.getElementById("photoHistory").innerHTML=data.photos.map(p=>`
<div class="list-item">
<strong>${p.date}</strong> - ${p.weight}kg
<img src="${p.url}">
</div>`).join("");
}

function exportBackup(){
const blob=new Blob([JSON.stringify(data)],{type:"application/json"});
const a=document.createElement("a");
a.href=URL.createObjectURL(blob);
a.download="logbook-backup.json";
a.click();
}

function importBackup(){
const file=document.getElementById("importFile").files[0];
if(!file)return;
const reader=new FileReader();
reader.onload=e=>{data=JSON.parse(e.target.result);saveData();renderAll();};
reader.readAsText(file);
}

function renderDashboard(){
const totalSessions=data.sessions.length;
const totalVolume=data.sessions.reduce((sum,s)=>sum+calculateVolume(s),0);
document.getElementById("dashboardStats").innerHTML=`
<div class="stat">Sessões: ${totalSessions}</div>
<div class="stat">Volume Total: ${totalVolume} kg</div>
<div class="stat">TDEE: ${data.tdee||"-"}</div>
<div class="stat">Fotos: ${data.photos.length}</div>
`;
}

function renderAll(){
document.getElementById("routineText").value=data.routine;
document.getElementById("todayRoutineTitle").innerText=getTodayRoutine();
renderHistory();
renderPhotos();
renderDashboard();
}

document.addEventListener("DOMContentLoaded",loadData);

</script>

</body>
</html>
